#!/usr/bin/env bash

# Push secrets to cloud storage

# Check if rclone is configured
if ! rclone listremotes | grep -q "config:"; then
    echo "Error: rclone remote 'config:' not found"
    echo "Please configure rclone first"
    exit 1
fi

# Push SSH keys
echo "Pushing SSH keys..."
rclone sync ~/.ssh/ config:/erik-config/ssh/

# Push AWS config
echo "Pushing AWS config..."
rclone sync ~/.aws/ config:/erik-config/aws/

# Push homelab ansible secrets
if [[ -f ~/code/homelab/ansible/secrets.yaml ]]; then
    echo "Pushing homelab ansible secrets..."
    rclone copy ~/code/homelab/ansible/secrets.yaml config:/erik-config/homelab/ansible/
fi

# Push API keys
if [[ -f ~/.secrets/api-keys ]]; then
    echo "Pushing API keys..."
    rclone copy ~/.secrets/api-keys config:/erik-config/secrets/
fi

echo "Secrets push complete!"